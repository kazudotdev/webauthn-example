/* esm.sh - esbuild bundle(asn1js@3.0.5) denonext production */
import*as f from"/v134/pvtsutils@1.3.5/denonext/pvtsutils.mjs";import*as d from"/v134/pvutils@1.1.3/denonext/pvutils.mjs";function D(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function pe(n){let e=0,t=0;for(let r=0;r<n.length;r++){let i=n[r];e+=i.byteLength}let s=new Uint8Array(e);for(let r=0;r<n.length;r++){let i=n[r];s.set(new Uint8Array(i),t),t+=i.byteLength}return s.buffer}function A(n,e,t,s){return e instanceof Uint8Array?e.byteLength?t<0?(n.error="Wrong parameter: inputOffset less than zero",!1):s<0?(n.error="Wrong parameter: inputLength less than zero",!1):e.byteLength-t-s<0?(n.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(n.error="Wrong parameter: inputBuffer has zero length",!1):(n.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}var R=class{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return pe(this.items)}},S=[new Uint8Array([1])],Me="0123456789",Te="name",Oe="valueHexView",yt="isHexOnly",mt="idBlock",Nt="tagClass",Et="tagNumber",At="isConstructed",Ct="fromBER",Vt="toBER",Ht="local",b="",y=new ArrayBuffer(0),Se=new Uint8Array(0),p="EndOfContent",_e="OCTET STRING",$e="BIT STRING";function C(n){var e;return e=class extends n{constructor(...s){var r;super(...s);let i=s[0]||{};this.isHexOnly=(r=i.isHexOnly)!==null&&r!==void 0?r:!1,this.valueHexView=i.valueHex?f.BufferSourceConverter.toUint8Array(i.valueHex):Se}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(s){this.valueHexView=new Uint8Array(s)}fromBER(s,r,i){let o=s instanceof ArrayBuffer?new Uint8Array(s):s;if(!A(this,o,r,i))return-1;let a=r+i;return this.valueHexView=o.subarray(r,a),this.valueHexView.length?(this.blockLength=i,a):(this.warnings.push("Zero buffer length"),r)}toBER(s=!1){return this.isHexOnly?s?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",y)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:f.Convert.ToHex(this.valueHexView)}}},e.NAME="hexBlock",e}var N=class{constructor({blockLength:e=0,error:t=b,warnings:s=[],valueBeforeDecode:r=Se}={}){this.blockLength=e,this.error=t,this.warnings=s,this.valueBeforeDecodeView=f.BufferSourceConverter.toUint8Array(r)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:f.Convert.ToHex(this.valueBeforeDecodeView)}}};N.NAME="baseBlock";var B=class extends N{fromBER(e,t,s){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}};B.NAME="valueBlock";var J=class extends C(N){constructor({idBlock:e={}}={}){var t,s,r,i;super(),e?(this.isHexOnly=(t=e.isHexOnly)!==null&&t!==void 0?t:!1,this.valueHexView=e.valueHex?f.BufferSourceConverter.toUint8Array(e.valueHex):Se,this.tagClass=(s=e.tagClass)!==null&&s!==void 0?s:-1,this.tagNumber=(r=e.tagNumber)!==null&&r!==void 0?r:-1,this.isConstructed=(i=e.isConstructed)!==null&&i!==void 0?i:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",y}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){let r=new Uint8Array(1);if(!e){let i=this.tagNumber;i&=31,t|=i,r[0]=t}return r.buffer}if(!this.isHexOnly){let r=d.utilToBase(this.tagNumber,7),i=new Uint8Array(r),o=r.byteLength,a=new Uint8Array(o+1);if(a[0]=t|31,!e){for(let l=0;l<o-1;l++)a[l+1]=i[l]|128;a[o]=i[o-1]}return a.buffer}let s=new Uint8Array(this.valueHexView.byteLength+1);if(s[0]=t|31,!e){let r=this.valueHexView;for(let i=0;i<r.length-1;i++)s[i+1]=r[i]|128;s[this.valueHexView.byteLength]=r[r.length-1]}return s.buffer}fromBER(e,t,s){let r=f.BufferSourceConverter.toUint8Array(e);if(!A(this,r,t,s))return-1;let i=r.subarray(t,t+s);if(i.length===0)return this.error="Zero buffer length",-1;switch(i[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(i[0]&32)===32,this.isHexOnly=!1;let a=i[0]&31;if(a!==31)this.tagNumber=a,this.blockLength=1;else{let l=1,c=this.valueHexView=new Uint8Array(255),v=255;for(;i[l]&128;){if(c[l-1]=i[l]&127,l++,l>=i.length)return this.error="End of input reached before message was fully decoded",-1;if(l===v){v+=255;let k=new Uint8Array(v);for(let x=0;x<c.length;x++)k[x]=c[x];c=this.valueHexView=new Uint8Array(v)}}this.blockLength=l+1,c[l-1]=i[l]&127;let h=new Uint8Array(l);for(let k=0;k<l;k++)h[k]=c[k];c=this.valueHexView=new Uint8Array(l),c.set(h),this.blockLength<=9?this.tagNumber=d.utilFromBase(c,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}};J.NAME="identificationBlock";var W=class extends N{constructor({lenBlock:e={}}={}){var t,s,r;super(),this.isIndefiniteForm=(t=e.isIndefiniteForm)!==null&&t!==void 0?t:!1,this.longFormUsed=(s=e.longFormUsed)!==null&&s!==void 0?s:!1,this.length=(r=e.length)!==null&&r!==void 0?r:0}fromBER(e,t,s){let r=f.BufferSourceConverter.toUint8Array(e);if(!A(this,r,t,s))return-1;let i=r.subarray(t,t+s);if(i.length===0)return this.error="Zero buffer length",-1;if(i[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=i[0]===128,this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(i[0]&128),this.longFormUsed===!1)return this.length=i[0],this.blockLength=1,t+this.blockLength;let o=i[0]&127;if(o>8)return this.error="Too big integer",-1;if(o+1>i.length)return this.error="End of input reached before message was fully decoded",-1;let a=t+1,l=r.subarray(a,a+o);return l[o-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=d.utilFromBase(l,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,t+this.blockLength}toBER(e=!1){let t,s;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),e===!1&&(s=new Uint8Array(t),s[0]=128),t;if(this.longFormUsed){let r=d.utilToBase(this.length,8);if(r.byteLength>127)return this.error="Too big length",y;if(t=new ArrayBuffer(r.byteLength+1),e)return t;let i=new Uint8Array(r);s=new Uint8Array(t),s[0]=r.byteLength|128;for(let o=0;o<r.byteLength;o++)s[o+1]=i[o];return t}return t=new ArrayBuffer(1),e===!1&&(s=new Uint8Array(t),s[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}};W.NAME="lengthBlock";var u={},g=class extends N{constructor({name:e=b,optional:t=!1,primitiveSchema:s,...r}={},i){super(r),this.name=e,this.optional=t,s&&(this.primitiveSchema=s),this.idBlock=new J(r),this.lenBlock=new W(r),this.valueBlock=i?new i(r):new B(r)}fromBER(e,t,s){let r=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?s:this.lenBlock.length);return r===-1?(this.error=this.valueBlock.error,r):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),r)}toBER(e,t){let s=t||new R;t||De(this);let r=this.idBlock.toBER(e);if(s.write(r),this.lenBlock.isIndefiniteForm)s.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,s),s.write(new ArrayBuffer(2));else{let i=this.valueBlock.toBER(e);this.lenBlock.length=i.byteLength;let o=this.lenBlock.toBER(e);s.write(o),s.write(i)}return t?y:s.final()}toJSON(){let e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return e==="ascii"?this.onAsciiEncoding():f.Convert.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${f.Convert.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;let t=this.toBER(),s=e.toBER();return d.isEqualBuffer(t,s)}};g.NAME="BaseBlock";function De(n){if(n instanceof u.Constructed)for(let e of n.valueBlock.value)De(e)&&(n.lenBlock.isIndefiniteForm=!0);return!!n.lenBlock.isIndefiniteForm}var G=class extends g{constructor({value:e=b,...t}={},s){super(t,s),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,s){let r=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?s:this.lenBlock.length);return r===-1?(this.error=this.valueBlock.error,r):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),r)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}};G.NAME="BaseStringBlock";var j=class extends C(B){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}};j.NAME="PrimitiveValueBlock";var Je,P=class extends g{constructor(e={}){super(e,j),this.idBlock.isConstructed=!1}};Je=P;u.Primitive=Je;P.NAME="PRIMITIVE";function Ut(n,e){if(n instanceof e)return n;let t=new e;return t.idBlock=n.idBlock,t.lenBlock=n.lenBlock,t.warnings=n.warnings,t.valueBeforeDecodeView=n.valueBeforeDecodeView,t}function U(n,e=0,t=n.length){let s=e,r=new g({},B),i=new N;if(!A(i,n,e,t))return r.error=i.error,{offset:-1,result:r};if(!n.subarray(e,e+t).length)return r.error="Zero buffer length",{offset:-1,result:r};let a=r.idBlock.fromBER(n,e,t);if(r.idBlock.warnings.length&&r.warnings.concat(r.idBlock.warnings),a===-1)return r.error=r.idBlock.error,{offset:-1,result:r};if(e=a,t-=r.idBlock.blockLength,a=r.lenBlock.fromBER(n,e,t),r.lenBlock.warnings.length&&r.warnings.concat(r.lenBlock.warnings),a===-1)return r.error=r.lenBlock.error,{offset:-1,result:r};if(e=a,t-=r.lenBlock.blockLength,!r.idBlock.isConstructed&&r.lenBlock.isIndefiniteForm)return r.error="Indefinite length form used for primitive encoding form",{offset:-1,result:r};let l=g;switch(r.idBlock.tagClass){case 1:if(r.idBlock.tagNumber>=37&&r.idBlock.isHexOnly===!1)return r.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:r};switch(r.idBlock.tagNumber){case 0:if(r.idBlock.isConstructed&&r.lenBlock.length>0)return r.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:r};l=u.EndOfContent;break;case 1:l=u.Boolean;break;case 2:l=u.Integer;break;case 3:l=u.BitString;break;case 4:l=u.OctetString;break;case 5:l=u.Null;break;case 6:l=u.ObjectIdentifier;break;case 10:l=u.Enumerated;break;case 12:l=u.Utf8String;break;case 13:l=u.RelativeObjectIdentifier;break;case 14:l=u.TIME;break;case 15:return r.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:r};case 16:l=u.Sequence;break;case 17:l=u.Set;break;case 18:l=u.NumericString;break;case 19:l=u.PrintableString;break;case 20:l=u.TeletexString;break;case 21:l=u.VideotexString;break;case 22:l=u.IA5String;break;case 23:l=u.UTCTime;break;case 24:l=u.GeneralizedTime;break;case 25:l=u.GraphicString;break;case 26:l=u.VisibleString;break;case 27:l=u.GeneralString;break;case 28:l=u.UniversalString;break;case 29:l=u.CharacterString;break;case 30:l=u.BmpString;break;case 31:l=u.DATE;break;case 32:l=u.TimeOfDay;break;case 33:l=u.DateTime;break;case 34:l=u.Duration;break;default:{let c=r.idBlock.isConstructed?new u.Constructed:new u.Primitive;c.idBlock=r.idBlock,c.lenBlock=r.lenBlock,c.warnings=r.warnings,r=c}}break;case 2:case 3:case 4:default:l=r.idBlock.isConstructed?u.Constructed:u.Primitive}return r=Ut(r,l),a=r.fromBER(n,e,r.lenBlock.isIndefiniteForm?t:r.lenBlock.length),r.valueBeforeDecodeView=n.subarray(s,s+r.blockLength),{offset:a,result:r}}function pt(n){if(!n.byteLength){let e=new g({},B);return e.error="Input buffer has zero length",{offset:-1,result:e}}return U(f.BufferSourceConverter.toUint8Array(n).slice(),0,n.byteLength)}function It(n,e){return n?1:e}var m=class extends B{constructor({value:e=[],isIndefiniteForm:t=!1,...s}={}){super(s),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,s){let r=f.BufferSourceConverter.toUint8Array(e);if(!A(this,r,t,s))return-1;if(this.valueBeforeDecodeView=r.subarray(t,t+s),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),t;let i=t;for(;It(this.isIndefiniteForm,s)>0;){let o=U(r,i,s);if(o.offset===-1)return this.error=o.result.error,this.warnings.concat(o.result.warnings),-1;if(i=o.offset,this.blockLength+=o.result.blockLength,s-=o.result.blockLength,this.value.push(o.result),this.isIndefiniteForm&&o.result.constructor.NAME===p)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===p?this.value.pop():this.warnings.push("No EndOfContent block encoded")),i}toBER(e,t){let s=t||new R;for(let r=0;r<this.value.length;r++)this.value[r].toBER(e,s);return t?y:s.final()}toJSON(){let e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(let t of this.value)e.value.push(t.toJSON());return e}};m.NAME="ConstructedValueBlock";var We,V=class extends g{constructor(e={}){super(e,m),this.idBlock.isConstructed=!0}fromBER(e,t,s){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;let r=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?s:this.lenBlock.length);return r===-1?(this.error=this.valueBlock.error,r):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),r)}onAsciiEncoding(){let e=[];for(let s of this.valueBlock.value)e.push(s.toString("ascii").split(`
`).map(r=>`  ${r}`).join(`
`));let t=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join(`
`)}`:`${t} :`}};We=V;u.Constructed=We;V.NAME="CONSTRUCTED";var Z=class extends B{fromBER(e,t,s){return t}toBER(e){return y}};Z.override="EndOfContentValueBlock";var Ge,Y=class extends g{constructor(e={}){super(e,Z),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}};Ge=Y;u.EndOfContent=Ge;Y.NAME=p;var je,q=class extends g{constructor(e={}){super(e,B),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,s){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=s,t+s>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+s}toBER(e,t){let s=new ArrayBuffer(2);if(!e){let r=new Uint8Array(s);r[0]=5,r[1]=0}return t&&t.write(s),s}onAsciiEncoding(){return`${this.constructor.NAME}`}};je=q;u.Null=je;q.NAME="NULL";var X=class extends C(B){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=f.BufferSourceConverter.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(let e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,s){let r=f.BufferSourceConverter.toUint8Array(e);return A(this,r,t,s)?(this.valueHexView=r.subarray(t,t+s),s>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,d.utilDecodeTC.call(this),this.blockLength=s,t+s):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}};X.NAME="BooleanValueBlock";var Pe,K=class extends g{constructor(e={}){super(e,X),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}};Pe=K;u.Boolean=Pe;K.NAME="BOOLEAN";var Q=class extends C(m){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,s){let r=0;if(this.isConstructed){if(this.isHexOnly=!1,r=m.prototype.fromBER.call(this,e,t,s),r===-1)return r;for(let i=0;i<this.value.length;i++){let o=this.value[i].constructor.NAME;if(o===p){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(o!==_e)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,r=super.fromBER(e,t,s),this.blockLength=s;return r}toBER(e,t){return this.isConstructed?m.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}};Q.NAME="OctetStringValueBlock";var Ze,z=class n extends g{constructor({idBlock:e={},lenBlock:t={},...s}={}){var r,i;(r=s.isConstructed)!==null&&r!==void 0||(s.isConstructed=!!(!((i=s.value)===null||i===void 0)&&i.length)),super({idBlock:{isConstructed:s.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!s.isIndefiniteForm},...s},Q),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,s){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,s===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){let i=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+s);try{if(i.byteLength){let o=U(i,0,i.byteLength);o.offset!==-1&&o.offset===s&&(this.valueBlock.value=[o.result])}}catch{}}return super.fromBER(e,t,s)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?V.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${f.Convert.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;let e=[];for(let t of this.valueBlock.value)t instanceof n&&e.push(t.valueBlock.valueHexView);return f.BufferSourceConverter.concat(e)}};Ze=z;u.OctetString=Ze;z.NAME=_e;var ee=class extends C(m){constructor({unusedBits:e=0,isConstructed:t=!1,...s}={}){super(s),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,s){if(!s)return t;let r=-1;if(this.isConstructed){if(r=m.prototype.fromBER.call(this,e,t,s),r===-1)return r;for(let a of this.value){let l=a.constructor.NAME;if(l===p){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(l!==$e)return this.error="BIT STRING may consists of BIT STRINGs only",-1;let c=a.valueBlock;if(this.unusedBits>0&&c.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=c.unusedBits}return r}let i=f.BufferSourceConverter.toUint8Array(e);if(!A(this,i,t,s))return-1;let o=i.subarray(t,t+s);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){let a=o.subarray(1);try{if(a.byteLength){let l=U(a,0,a.byteLength);l.offset!==-1&&l.offset===s-1&&(this.value=[l.result])}}catch{}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,t+s}toBER(e,t){if(this.isConstructed)return m.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return y;let s=new Uint8Array(this.valueHexView.length+1);return s[0]=this.unusedBits,s.set(this.valueHexView,1),s.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}};ee.NAME="BitStringValueBlock";var Ye,te=class extends g{constructor({idBlock:e={},lenBlock:t={},...s}={}){var r,i;(r=s.isConstructed)!==null&&r!==void 0||(s.isConstructed=!!(!((i=s.value)===null||i===void 0)&&i.length)),super({idBlock:{isConstructed:s.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!s.isIndefiniteForm},...s},ee),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,s){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,s)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return V.prototype.onAsciiEncoding.call(this);{let e=[],t=this.valueBlock.valueHexView;for(let r of t)e.push(r.toString(2).padStart(8,"0"));let s=e.join("");return`${this.constructor.NAME} : ${s.substring(0,s.length-this.valueBlock.unusedBits)}`}}};Ye=te;u.BitString=Ye;te.NAME=$e;var qe;function St(n,e){let t=new Uint8Array([0]),s=new Uint8Array(n),r=new Uint8Array(e),i=s.slice(0),o=i.length-1,a=r.slice(0),l=a.length-1,c=0,v=l<o?o:l,h=0;for(let k=v;k>=0;k--,h++){switch(!0){case h<a.length:c=i[o-h]+a[l-h]+t[0];break;default:c=i[o-h]+t[0]}switch(t[0]=c/10,!0){case h>=i.length:i=d.utilConcatView(new Uint8Array([c%10]),i);break;default:i[o-h]=c%10}}return t[0]>0&&(i=d.utilConcatView(t,i)),i}function Fe(n){if(n>=S.length)for(let e=S.length;e<=n;e++){let t=new Uint8Array([0]),s=S[e-1].slice(0);for(let r=s.length-1;r>=0;r--){let i=new Uint8Array([(s[r]<<1)+t[0]]);t[0]=i[0]/10,s[r]=i[0]%10}t[0]>0&&(s=d.utilConcatView(t,s)),S.push(s)}return S[n]}function Tt(n,e){let t=0,s=new Uint8Array(n),r=new Uint8Array(e),i=s.slice(0),o=i.length-1,a=r.slice(0),l=a.length-1,c,v=0;for(let h=l;h>=0;h--,v++)switch(c=i[o-v]-a[l-v]-t,!0){case c<0:t=1,i[o-v]=c+10;break;default:t=0,i[o-v]=c}if(t>0)for(let h=o-l+1;h>=0;h--,v++)if(c=i[o-v]-t,c<0)t=1,i[o-v]=c+10;else{t=0,i[o-v]=c;break}return i.slice()}var M=class extends C(B){constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),e!==void 0&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=d.utilDecodeTC.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(d.utilEncodeTC(e))}get valueDec(){return this._valueDec}fromDER(e,t,s,r=0){let i=this.fromBER(e,t,s);if(i===-1)return i;let o=this.valueHexView;return o[0]===0&&o[1]&128?this.valueHexView=o.subarray(1):r!==0&&o.length<r&&(r-o.length>1&&(r=o.length+1),this.valueHexView=o.subarray(r-o.length)),i}toDER(e=!1){let t=this.valueHexView;switch(!0){case(t[0]&128)!==0:{let s=new Uint8Array(this.valueHexView.length+1);s[0]=0,s.set(t,1),this.valueHexView=s}break;case(t[0]===0&&(t[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(e)}fromBER(e,t,s){let r=super.fromBER(e,t,s);return r===-1||this.setValueHex(),r}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){let e=this.valueHexView.length*8-1,t=new Uint8Array(this.valueHexView.length*8/3),s=0,r,i=this.valueHexView,o="",a=!1;for(let l=i.byteLength-1;l>=0;l--){r=i[l];for(let c=0;c<8;c++){if((r&1)===1)switch(s){case e:t=Tt(Fe(s),t),o="-";break;default:t=St(t,Fe(s))}s++,r>>=1}}for(let l=0;l<t.length;l++)t[l]&&(a=!0),a&&(o+=Me.charAt(t[l]));return a===!1&&(o+=Me.charAt(0)),o}};qe=M;M.NAME="IntegerValueBlock";Object.defineProperty(qe.prototype,"valueHex",{set:function(n){this.valueHexView=new Uint8Array(n),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var Xe,O=class n extends g{constructor(e={}){super(e,M),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return D(),BigInt(this.valueBlock.toString())}static fromBigInt(e){D();let t=BigInt(e),s=new R,r=t.toString(16).replace(/^-/,""),i=new Uint8Array(f.Convert.FromHex(r));if(t<0){let a=new Uint8Array(i.length+(i[0]&128?1:0));a[0]|=128;let c=BigInt(`0x${f.Convert.ToHex(a)}`)+t,v=f.BufferSourceConverter.toUint8Array(f.Convert.FromHex(c.toString(16)));v[0]|=128,s.write(v)}else i[0]&128&&s.write(new Uint8Array([0])),s.write(i);return new n({valueHex:s.final()})}convertToDER(){let e=new n({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new n({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}};Xe=O;u.Integer=Xe;O.NAME="INTEGER";var Ke,re=class extends O{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}};Ke=re;u.Enumerated=Ke;re.NAME="ENUMERATED";var F=class extends C(B){constructor({valueDec:e=-1,isFirstSid:t=!1,...s}={}){super(s),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,s){if(!s)return t;let r=f.BufferSourceConverter.toUint8Array(e);if(!A(this,r,t,s))return-1;let i=r.subarray(t,t+s);this.valueHexView=new Uint8Array(s);for(let a=0;a<s&&(this.valueHexView[a]=i[a]&127,this.blockLength++,!!(i[a]&128));a++);let o=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength;a++)o[a]=this.valueHexView[a];return this.valueHexView=o,i[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=d.utilFromBase(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){D();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;let s=new Uint8Array(t.length/7);for(let r=0;r<s.length;r++)s[r]=parseInt(t.slice(r*7,r*7+7),2)+(r+1<s.length?128:0);this.fromBER(s.buffer,0,s.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let r=this.valueHexView,i=new Uint8Array(this.blockLength);for(let o=0;o<this.blockLength-1;o++)i[o]=r[o]|128;return i[this.blockLength-1]=r[this.blockLength-1],i.buffer}let t=d.utilToBase(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",y;let s=new Uint8Array(t.byteLength);if(!e){let r=new Uint8Array(t),i=t.byteLength-1;for(let o=0;o<i;o++)s[o]=r[o]|128;s[i]=r[i]}return s}toString(){let e="";if(this.isHexOnly)e=f.Convert.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}};F.NAME="sidBlock";var se=class extends B{constructor({value:e=b,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,s){let r=t;for(;s>0;){let i=new F;if(r=i.fromBER(e,r,s),r===-1)return this.blockLength=0,this.error=i.error,r;this.value.length===0&&(i.isFirstSid=!0),this.blockLength+=i.blockLength,s-=i.blockLength,this.value.push(i)}return r}toBER(e){let t=[];for(let s=0;s<this.value.length;s++){let r=this.value[s].toBER(e);if(r.byteLength===0)return this.error=this.value[s].error,y;t.push(r)}return pe(t)}fromString(e){this.value=[];let t=0,s=0,r="",i=!1;do if(s=e.indexOf(".",t),s===-1?r=e.substring(t):r=e.substring(t,s),t=s+1,i){let o=this.value[0],a=0;switch(o.valueDec){case 0:break;case 1:a=40;break;case 2:a=80;break;default:this.value=[];return}let l=parseInt(r,10);if(isNaN(l))return;o.valueDec=l+a,i=!1}else{let o=new F;if(r>Number.MAX_SAFE_INTEGER){D();let a=BigInt(r);o.valueBigInt=a}else if(o.valueDec=parseInt(r,10),isNaN(o.valueDec))return;this.value.length||(o.isFirstSid=!0,i=!0),this.value.push(o)}while(s!==-1)}toString(){let e="",t=!1;for(let s=0;s<this.value.length;s++){t=this.value[s].isHexOnly;let r=this.value[s].toString();s!==0&&(e=`${e}.`),t?(r=`{${r}}`,this.value[s].isFirstSid?e=`2.{${r} - 80}`:e+=r):e+=r}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}};se.NAME="ObjectIdentifierValueBlock";var Qe,ie=class extends g{constructor(e={}){super(e,se),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}};Qe=ie;u.ObjectIdentifier=Qe;ie.NAME="OBJECT IDENTIFIER";var L=class extends C(N){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,s){if(s===0)return t;let r=f.BufferSourceConverter.toUint8Array(e);if(!A(this,r,t,s))return-1;let i=r.subarray(t,t+s);this.valueHexView=new Uint8Array(s);for(let a=0;a<s&&(this.valueHexView[a]=i[a]&127,this.blockLength++,!!(i[a]&128));a++);let o=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength;a++)o[a]=this.valueHexView[a];return this.valueHexView=o,i[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=d.utilFromBase(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let r=this.valueHexView,i=new Uint8Array(this.blockLength);for(let o=0;o<this.blockLength-1;o++)i[o]=r[o]|128;return i[this.blockLength-1]=r[this.blockLength-1],i.buffer}let t=d.utilToBase(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",y;let s=new Uint8Array(t.byteLength);if(!e){let r=new Uint8Array(t),i=t.byteLength-1;for(let o=0;o<i;o++)s[o]=r[o]|128;s[i]=r[i]}return s.buffer}toString(){let e="";return this.isHexOnly?e=f.Convert.ToHex(this.valueHexView):e=this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}};L.NAME="relativeSidBlock";var ne=class extends B{constructor({value:e=b,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,s){let r=t;for(;s>0;){let i=new L;if(r=i.fromBER(e,r,s),r===-1)return this.blockLength=0,this.error=i.error,r;this.blockLength+=i.blockLength,s-=i.blockLength,this.value.push(i)}return r}toBER(e,t){let s=[];for(let r=0;r<this.value.length;r++){let i=this.value[r].toBER(e);if(i.byteLength===0)return this.error=this.value[r].error,y;s.push(i)}return pe(s)}fromString(e){this.value=[];let t=0,s=0,r="";do{s=e.indexOf(".",t),s===-1?r=e.substring(t):r=e.substring(t,s),t=s+1;let i=new L;if(i.valueDec=parseInt(r,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(s!==-1);return!0}toString(){let e="",t=!1;for(let s=0;s<this.value.length;s++){t=this.value[s].isHexOnly;let r=this.value[s].toString();s!==0&&(e=`${e}.`),t&&(r=`{${r}}`),e+=r}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}};ne.NAME="RelativeObjectIdentifierValueBlock";var ze,oe=class extends g{constructor(e={}){super(e,ne),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}};ze=oe;u.RelativeObjectIdentifier=ze;oe.NAME="RelativeObjectIdentifier";var et,le=class extends V{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}};et=le;u.Sequence=et;le.NAME="SEQUENCE";var tt,ae=class extends V{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};tt=ae;u.Set=tt;ae.NAME="SET";var ue=class extends C(B){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=b}toJSON(){return{...super.toJSON(),value:this.value}}};ue.NAME="StringValueBlock";var ce=class extends ue{};ce.NAME="SimpleStringValueBlock";var w=class extends G{constructor({...e}={}){super(e,ce)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,f.BufferSourceConverter.toUint8Array(e))}fromString(e){let t=e.length,s=this.valueBlock.valueHexView=new Uint8Array(t);for(let r=0;r<t;r++)s[r]=e.charCodeAt(r);this.valueBlock.value=e}};w.NAME="SIMPLE STRING";var he=class extends w{fromBuffer(e){this.valueBlock.valueHexView=f.BufferSourceConverter.toUint8Array(e);try{this.valueBlock.value=f.Convert.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=f.Convert.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(f.Convert.FromUtf8String(e)),this.valueBlock.value=e}};he.NAME="Utf8StringValueBlock";var rt,E=class extends he{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}};rt=E;u.Utf8String=rt;E.NAME="UTF8String";var fe=class extends w{fromBuffer(e){this.valueBlock.value=f.Convert.ToUtf16String(e),this.valueBlock.valueHexView=f.BufferSourceConverter.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(f.Convert.FromUtf16String(e))}};fe.NAME="BmpStringValueBlock";var st,de=class extends fe{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}};st=de;u.BmpString=st;de.NAME="BMPString";var ve=class extends w{fromBuffer(e){let t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),s=new Uint8Array(t);for(let r=0;r<s.length;r+=4)s[r]=s[r+3],s[r+1]=s[r+2],s[r+2]=0,s[r+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){let t=e.length,s=this.valueBlock.valueHexView=new Uint8Array(t*4);for(let r=0;r<t;r++){let i=d.utilToBase(e.charCodeAt(r),8),o=new Uint8Array(i);if(o.length>4)continue;let a=4-o.length;for(let l=o.length-1;l>=0;l--)s[r*4+l+a]=o[l]}this.valueBlock.value=e}};ve.NAME="UniversalStringValueBlock";var it,ge=class extends ve{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}};it=ge;u.UniversalString=it;ge.NAME="UniversalString";var nt,Be=class extends w{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}};nt=Be;u.NumericString=nt;Be.NAME="NumericString";var ot,ke=class extends w{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}};ot=ke;u.PrintableString=ot;ke.NAME="PrintableString";var lt,we=class extends w{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}};lt=we;u.TeletexString=lt;we.NAME="TeletexString";var at,be=class extends w{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}};at=be;u.VideotexString=at;be.NAME="VideotexString";var ut,xe=class extends w{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}};ut=xe;u.IA5String=ut;xe.NAME="IA5String";var ct,ye=class extends w{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}};ct=ye;u.GraphicString=ct;ye.NAME="GraphicString";var ht,_=class extends w{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}};ht=_;u.VisibleString=ht;_.NAME="VisibleString";var ft,me=class extends w{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}};ft=me;u.GeneralString=ft;me.NAME="GeneralString";var dt,Ne=class extends w{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}};dt=Ne;u.CharacterString=dt;Ne.NAME="CharacterString";var vt,$=class extends _{constructor({value:e,valueDate:t,...s}={}){if(super(s),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let r=0;r<e.length;r++)this.valueBlock.valueHexView[r]=e.charCodeAt(r)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,f.BufferSourceConverter.toUint8Array(e)))}toBuffer(){let e=this.toString(),t=new ArrayBuffer(e.length),s=new Uint8Array(t);for(let r=0;r<e.length;r++)s[r]=e.charCodeAt(r);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){let s=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(s===null){this.error="Wrong input string for conversion";return}let r=parseInt(s[1],10);r>=50?this.year=1900+r:this.year=2e3+r,this.month=parseInt(s[2],10),this.day=parseInt(s[3],10),this.hour=parseInt(s[4],10),this.minute=parseInt(s[5],10),this.second=parseInt(s[6],10)}toString(e="iso"){if(e==="iso"){let t=new Array(7);return t[0]=d.padNumber(this.year<2e3?this.year-1900:this.year-2e3,2),t[1]=d.padNumber(this.month,2),t[2]=d.padNumber(this.day,2),t[3]=d.padNumber(this.hour,2),t[4]=d.padNumber(this.minute,2),t[5]=d.padNumber(this.second,2),t[6]="Z",t.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}};vt=$;u.UTCTime=vt;$.NAME="UTCTime";var gt,Ee=class extends ${constructor(e={}){var t;super(e),(t=this.millisecond)!==null&&t!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t=!1,s="",r="",i=0,o,a=0,l=0;if(e[e.length-1]==="Z")s=e.substring(0,e.length-1),t=!0;else{let h=new Number(e[e.length-1]);if(isNaN(h.valueOf()))throw new Error("Wrong input string for conversion");s=e}if(t){if(s.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(s.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let h=1,k=s.indexOf("+"),x="";if(k===-1&&(k=s.indexOf("-"),h=-1),k!==-1){if(x=s.substring(k+1),s=s.substring(0,k),x.length!==2&&x.length!==4)throw new Error("Wrong input string for conversion");let I=parseInt(x.substring(0,2),10);if(isNaN(I.valueOf()))throw new Error("Wrong input string for conversion");if(a=h*I,x.length===4){if(I=parseInt(x.substring(2,4),10),isNaN(I.valueOf()))throw new Error("Wrong input string for conversion");l=h*I}}}let c=s.indexOf(".");if(c===-1&&(c=s.indexOf(",")),c!==-1){let h=new Number(`0${s.substring(c)}`);if(isNaN(h.valueOf()))throw new Error("Wrong input string for conversion");i=h.valueOf(),r=s.substring(0,c)}else r=s;switch(!0){case r.length===8:if(o=/(\d{4})(\d{2})(\d{2})/ig,c!==-1)throw new Error("Wrong input string for conversion");break;case r.length===10:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,c!==-1){let h=60*i;this.minute=Math.floor(h),h=60*(h-this.minute),this.second=Math.floor(h),h=1e3*(h-this.second),this.millisecond=Math.floor(h)}break;case r.length===12:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,c!==-1){let h=60*i;this.second=Math.floor(h),h=1e3*(h-this.second),this.millisecond=Math.floor(h)}break;case r.length===14:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,c!==-1){let h=1e3*i;this.millisecond=Math.floor(h)}break;default:throw new Error("Wrong input string for conversion")}let v=o.exec(r);if(v===null)throw new Error("Wrong input string for conversion");for(let h=1;h<v.length;h++)switch(h){case 1:this.year=parseInt(v[h],10);break;case 2:this.month=parseInt(v[h],10);break;case 3:this.day=parseInt(v[h],10);break;case 4:this.hour=parseInt(v[h],10)+a;break;case 5:this.minute=parseInt(v[h],10)+l;break;case 6:this.second=parseInt(v[h],10);break;default:throw new Error("Wrong input string for conversion")}if(t===!1){let h=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=h.getUTCFullYear(),this.month=h.getUTCMonth(),this.day=h.getUTCDay(),this.hour=h.getUTCHours(),this.minute=h.getUTCMinutes(),this.second=h.getUTCSeconds(),this.millisecond=h.getUTCMilliseconds()}}toString(e="iso"){if(e==="iso"){let t=[];return t.push(d.padNumber(this.year,4)),t.push(d.padNumber(this.month,2)),t.push(d.padNumber(this.day,2)),t.push(d.padNumber(this.hour,2)),t.push(d.padNumber(this.minute,2)),t.push(d.padNumber(this.second,2)),this.millisecond!==0&&(t.push("."),t.push(d.padNumber(this.millisecond,3))),t.push("Z"),t.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}};gt=Ee;u.GeneralizedTime=gt;Ee.NAME="GeneralizedTime";var Bt,Ae=class extends E{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}};Bt=Ae;u.DATE=Bt;Ae.NAME="DATE";var kt,Ce=class extends E{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}};kt=Ce;u.TimeOfDay=kt;Ce.NAME="TimeOfDay";var wt,Ve=class extends E{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}};wt=Ve;u.DateTime=wt;Ve.NAME="DateTime";var bt,He=class extends E{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}};bt=He;u.Duration=bt;He.NAME="Duration";var xt,Ue=class extends E{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}};xt=Ue;u.TIME=xt;Ue.NAME="TIME";var H=class{constructor({name:e=b,optional:t=!1}={}){this.name=e,this.optional=t}},Re=class extends H{constructor({value:e=[],...t}={}){super(t),this.value=e}},Ie=class extends H{constructor({value:e=new H,local:t=!1,...s}={}){super(s),this.value=e,this.local=t}},Le=class{constructor({data:e=Se}={}){this.dataView=f.BufferSourceConverter.toUint8Array(e)}get data(){return this.dataView.slice().buffer}set data(e){this.dataView=f.BufferSourceConverter.toUint8Array(e)}fromBER(e,t,s){let r=t+s;return this.dataView=f.BufferSourceConverter.toUint8Array(e).subarray(t,r),r}toBER(e){return this.dataView.slice().buffer}};function T(n,e,t){if(t instanceof Re){for(let i=0;i<t.value.length;i++)if(T(n,e,t.value[i]).verified)return{verified:!0,result:n};{let i={verified:!1,result:{error:"Wrong values for Choice type"}};return t.hasOwnProperty(Te)&&(i.name=t.name),i}}if(t instanceof H)return t.hasOwnProperty(Te)&&(n[t.name]=e),{verified:!0,result:n};if(!(n instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(mt in t))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Ct in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Vt in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let s=t.idBlock.toBER(!1);if(s.byteLength===0)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(t.idBlock.fromBER(s,0,s.byteLength)===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(t.idBlock.hasOwnProperty(Nt)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagClass!==e.idBlock.tagClass)return{verified:!1,result:n};if(t.idBlock.hasOwnProperty(Et)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagNumber!==e.idBlock.tagNumber)return{verified:!1,result:n};if(t.idBlock.hasOwnProperty(At)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isConstructed!==e.idBlock.isConstructed)return{verified:!1,result:n};if(!(yt in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isHexOnly!==e.idBlock.isHexOnly)return{verified:!1,result:n};if(t.idBlock.isHexOnly){if(!(Oe in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=t.idBlock.valueHexView,o=e.idBlock.valueHexView;if(i.length!==o.length)return{verified:!1,result:n};for(let a=0;a<i.length;a++)if(i[a]!==o[1])return{verified:!1,result:n}}if(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,b),t.name&&(n[t.name]=e)),t instanceof u.Constructed){let i=0,o={verified:!1,result:{error:"Unknown error"}},a=t.valueBlock.value.length;if(a>0&&t.valueBlock.value[0]instanceof Ie&&(a=e.valueBlock.value.length),a===0)return{verified:!0,result:n};if(e.valueBlock.value.length===0&&t.valueBlock.value.length!==0){let l=!0;for(let c=0;c<t.valueBlock.value.length;c++)l=l&&(t.valueBlock.value[c].optional||!1);return l?{verified:!0,result:n}:(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,b),t.name&&delete n[t.name]),n.error="Inconsistent object length",{verified:!1,result:n})}for(let l=0;l<a;l++)if(l-i>=e.valueBlock.value.length){if(t.valueBlock.value[l].optional===!1){let c={verified:!1,result:n};return n.error="Inconsistent length between ASN.1 data and schema",t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,b),t.name&&(delete n[t.name],c.name=t.name)),c}}else if(t.valueBlock.value[0]instanceof Ie){if(o=T(n,e.valueBlock.value[l],t.valueBlock.value[0].value),o.verified===!1)if(t.valueBlock.value[0].optional)i++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,b),t.name&&delete n[t.name]),o;if(Te in t.valueBlock.value[0]&&t.valueBlock.value[0].name.length>0){let c={};Ht in t.valueBlock.value[0]&&t.valueBlock.value[0].local?c=e:c=n,typeof c[t.valueBlock.value[0].name]>"u"&&(c[t.valueBlock.value[0].name]=[]),c[t.valueBlock.value[0].name].push(e.valueBlock.value[l])}}else if(o=T(n,e.valueBlock.value[l-i],t.valueBlock.value[l]),o.verified===!1)if(t.valueBlock.value[l].optional)i++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,b),t.name&&delete n[t.name]),o;if(o.verified===!1){let l={verified:!1,result:n};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,b),t.name&&(delete n[t.name],l.name=t.name)),l}return{verified:!0,result:n}}if(t.primitiveSchema&&Oe in e.valueBlock){let i=U(e.valueBlock.valueHexView);if(i.offset===-1){let o={verified:!1,result:i.result};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,b),t.name&&(delete n[t.name],o.name=t.name)),o}return T(n,i.result,t.primitiveSchema)}return{verified:!0,result:n}}function Mt(n,e){if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};let t=U(f.BufferSourceConverter.toUint8Array(n));return t.offset===-1?{verified:!1,result:t.result}:T(t.result,t.result,e)}export{H as Any,g as BaseBlock,G as BaseStringBlock,te as BitString,de as BmpString,K as Boolean,Ne as CharacterString,Re as Choice,V as Constructed,Ae as DATE,Ve as DateTime,He as Duration,Y as EndOfContent,re as Enumerated,me as GeneralString,Ee as GeneralizedTime,ye as GraphicString,C as HexBlock,xe as IA5String,O as Integer,q as Null,Be as NumericString,ie as ObjectIdentifier,z as OctetString,P as Primitive,ke as PrintableString,Le as RawData,oe as RelativeObjectIdentifier,Ie as Repeated,le as Sequence,ae as Set,Ue as TIME,we as TeletexString,Ce as TimeOfDay,$ as UTCTime,ge as UniversalString,E as Utf8String,B as ValueBlock,be as VideotexString,R as ViewWriter,_ as VisibleString,T as compareSchema,pt as fromBER,Mt as verifySchema};
/*! Bundled license information:

asn1js/build/index.es.js:
  (*!
   * Copyright (c) 2014, GMO GlobalSign
   * Copyright (c) 2015-2022, Peculiar Ventures
   * All rights reserved.
   * 
   * Author 2014-2019, Yury Strozhevsky
   * 
   * Redistribution and use in source and binary forms, with or without modification,
   * are permitted provided that the following conditions are met:
   * 
   * * Redistributions of source code must retain the above copyright notice, this
   *   list of conditions and the following disclaimer.
   * 
   * * Redistributions in binary form must reproduce the above copyright notice, this
   *   list of conditions and the following disclaimer in the documentation and/or
   *   other materials provided with the distribution.
   * 
   * * Neither the name of the copyright holder nor the names of its
   *   contributors may be used to endorse or promote products derived from
   *   this software without specific prior written permission.
   * 
   * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
   * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
   * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
   * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
   * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
   * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
   * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
   * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
   * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
   * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
   * 
   *)
*/
//# sourceMappingURL=asn1js.mjs.map